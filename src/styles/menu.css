/**
 * Menu System
 * Unified full-screen menu with panel-based navigation
 * Swiss/International Typographic Style
 *
 * All values use the 8px grid system from grid.css
 * Toggle button styles in menu-toggle.css
 */

/* =============================================
   Menu Container
   Full-screen overlay - Note: visibility/opacity handled by Svelte
   conditional rendering ({#if menuStore.isOpen}), not CSS animation.
   ============================================= */

.menu__inner {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

/* =============================================
   Panel System
   Swappable content areas
   ============================================= */
.menu__panel {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  opacity: 0;
  transform: translateX(var(--space-2));
  transition:
    opacity var(--transition-normal),
    transform var(--transition-normal);
  pointer-events: none;
}

.menu__panel--active {
  opacity: 1;
  transform: translateX(0);
  pointer-events: auto;
}

/* =============================================
   Panel Header
   Fixed height bar with back button and title
   Aligned to hamburger position
   ============================================= */
.menu__header {
  position: absolute;
  inset-block-start: var(--space-1);
  inset-inline: 0;
  display: flex;
  align-items: center;
  height: calc(var(--unit) * 6.5); /* 52px - button height + padding */
  padding-inline-start: calc(var(--unit) * 6.5); /* 52px - align with hamburger */
  padding-inline-end: var(--space-5);
  gap: var(--space-2);
}

/* Back button - hidden since hamburger transforms to arrow */
.menu__back {
  display: none;
}

.menu__title {
  margin: 0;
  font-size: var(--text-3xl);
  font-weight: var(--weight-bold);
  line-height: var(--leading-tight);
}

/* =============================================
   Panel Content
   Main content area below header
   Left-aligned, Swiss grid style
   ============================================= */
.menu__content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--space-5);
  width: 100%;
  max-width: calc(var(--unit) * 120); /* 960px */
  padding: var(--space-5);
  padding-block-start: calc(var(--unit) * 11); /* 88px - header + breathing room */
  padding-inline-start: calc(var(--unit) * 6.5); /* 52px - align with header */
  box-sizing: border-box;
}

/* =============================================
   Section Styles
   Grouped content with titles
   ============================================= */
.menu__section {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.menu__section-title {
  margin: 0;
  padding-block-end: var(--space-1);
  margin-block-end: var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: rgba(var(--color-foreground), 0.4);
  border-block-end: 1px solid rgb(var(--color-foreground));
}

/* =============================================
   Action Buttons
   Menu items with label and description
   ============================================= */
.menu__action {
  display: flex;
  flex-direction: column;
  gap: calc(var(--unit) * 0.5); /* 4px */
  width: 100%;
  padding-block: var(--space-2);
  border: none;
  background: none;
  color: rgb(var(--color-foreground));
  text-align: start;
  cursor: pointer;
  transition: opacity var(--transition-fast);
}

.menu__action:hover:not(:disabled) {
  opacity: var(--opacity-secondary);
}

.menu__action:active:not(:disabled) {
  opacity: var(--opacity-tertiary);
}

.menu__action:focus {
  outline: none;
}

.menu__action:disabled {
  opacity: var(--opacity-muted);
  cursor: not-allowed;
}

.menu__action--danger .menu__action-label {
  color: rgb(var(--color-danger, 220, 53, 69));
}

.menu__action--loading {
  position: relative;
}

.menu__action--loading::after {
  content: '';
  position: absolute;
  inset-block-start: 50%;
  inset-inline-end: var(--space-2);
  width: var(--space-2); /* 16px */
  height: var(--space-2); /* 16px */
  margin-block-start: calc(var(--space-1) * -1); /* -8px */
  border: calc(var(--unit) * 0.25) solid
    rgba(var(--color-foreground), 0.2); /* 2px */
  border-top-color: rgb(var(--color-foreground));
  border-radius: 50%;
  animation: menu-spinner 0.8s linear infinite;
}

.menu__action-label {
  font-size: var(--text-xl);
  font-weight: var(--weight-bold);
  line-height: var(--leading-tight);
}

.menu__action-desc {
  font-size: var(--text-base); /* 14px */
  font-weight: var(--weight-normal);
  opacity: var(--opacity-tertiary);
}

@keyframes menu-spinner {
  to {
    transform: rotate(360deg);
  }
}

/* =============================================
   Form Elements
   ============================================= */
.menu__form-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.menu__form-row .input {
  flex: 0 1 calc(var(--unit) * 40); /* 40 units = 320px */
  padding: var(--space-1) var(--space-3);
  font-size: var(--text-sm);
  border-radius: 100px;
  border: 1px solid rgba(var(--color-foreground), 0.3);
  background: transparent;
}

.menu__form-row .input:focus {
  border-color: rgb(var(--color-foreground));
  background: transparent;
}

.menu__form-row .menu__action {
  flex-shrink: 0;
  width: auto;
  padding-block: 0;
}

.menu__form-row .menu__action-label {
  font-size: var(--text-sm);
}

.menu__placeholder {
  margin: 0;
  font-size: var(--text-sm);
  opacity: var(--opacity-tertiary);
}

/* =============================================
   Account Card
   User info display in settings
   ============================================= */
.menu__account-card {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding-block: var(--space-2);
}

.menu__avatar {
  width: var(--space-6); /* 48px */
  height: var(--space-6); /* 48px */
  border-radius: 50%;
  object-fit: cover;
  background: rgba(var(--color-foreground), 0.1);
}

.menu__avatar-placeholder {
  width: var(--space-6); /* 48px */
  height: var(--space-6); /* 48px */
  border-radius: 50%;
  background: rgba(var(--color-foreground), 0.1);
}

.menu__account-details {
  display: flex;
  flex-direction: column;
  gap: calc(var(--unit) * 0.25); /* 2px */
}

.menu__account-name {
  font-size: var(--text-base);
  font-weight: var(--weight-bold);
}

.menu__account-email {
  font-size: var(--text-sm);
  opacity: var(--opacity-tertiary);
}

.menu__account-anon {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.menu__account-anon p {
  margin: 0;
  font-size: var(--text-md); /* 16px */
  opacity: var(--opacity-tertiary);
}

/* =============================================
   Sessions List
   Session items with actions
   ============================================= */
.menu__sessions-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  max-block-size: calc(100vh - var(--unit) * 25); /* 200px */
  overflow-y: auto;
}

.menu__session {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding-block: var(--space-2);
  border-block-end: 1px solid rgba(var(--color-foreground), 0.1);
}

.menu__session:last-child {
  border-block-end: none;
}

.menu__session--active {
  background: rgba(var(--color-accent, 255, 215, 0), 0.05);
  margin-inline: calc(var(--space-2) * -1);
  padding-inline: var(--space-2);
}

.menu__session-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  min-width: 0;
}

.menu__session-name {
  font-size: var(--text-base);
  font-weight: var(--weight-bold);
  cursor: text;
  outline: none;
}

.menu__session-name[contenteditable='true'] {
  text-decoration: underline;
  text-decoration-color: rgba(var(--color-foreground), 0.4);
  text-underline-offset: 3px;
}

.menu__session-date {
  font-size: var(--text-xs);
  opacity: var(--opacity-tertiary);
}

.menu__session-badge {
  padding: calc(var(--unit) * 0.25) var(--space-1); /* 2px 8px */
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  background: rgba(var(--color-accent, 255, 215, 0), 0.2);
  color: rgb(var(--color-foreground));
}

.menu__session-actions {
  display: flex;
  gap: var(--space-1);
}

.menu__session-actions button {
  padding: var(--space-1);
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  font-family: inherit;
  color: rgb(var(--color-foreground));
  background: transparent;
  border: none;
  cursor: pointer;
  opacity: var(--opacity-tertiary);
  transition: opacity var(--transition-fast);
}

.menu__session-actions button:hover:not(:disabled) {
  opacity: 1;
}

.menu__session-actions button:disabled {
  opacity: var(--opacity-muted);
  cursor: not-allowed;
}

.menu__session-actions button[data-action='delete'] {
  color: rgb(var(--color-danger, 220, 53, 69));
}

.menu__sessions-empty,
.menu__sessions-loading {
  padding-block: var(--space-4);
  font-size: var(--text-sm);
  opacity: var(--opacity-tertiary);
  text-align: center;
}

/* =============================================
   Email Sent State
   ============================================= */
.menu__sent {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
  text-align: center;
  padding-block: var(--space-4);
}

.menu__sent-icon {
  opacity: var(--opacity-secondary);
}

.menu__sent-title {
  margin: 0;
  font-size: var(--text-lg);
  font-weight: var(--weight-bold);
}

.menu__sent-message {
  margin: 0;
  font-size: var(--text-base);
  opacity: var(--opacity-secondary);
}

.menu__sent-email {
  font-weight: var(--weight-bold);
  opacity: 1;
}

/* =============================================
   Google Button Icon
   ============================================= */
.menu__google-icon {
  flex-shrink: 0;
  width: calc(var(--unit) * 2.25); /* 18px */
  height: calc(var(--unit) * 2.25); /* 18px */
}

/* =============================================
   Desktop Grid Layout
   Two-column grid for wider screens
   ============================================= */
@media (min-width: 600px) {
  /* 75 grid units */
  .menu__section--grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-2) var(--space-3);
  }

  .menu__section--grid .menu__section-title {
    grid-column: 1 / -1;
  }
}

/* Mobile adjustments */
@media only screen and (max-width: 600px) {
  /* 75 grid units */
  .menu__header {
    padding-inline: calc(var(--unit) * 2.5); /* 20px */
    padding-inline-start: calc(var(--unit) * 6.5); /* 52px */
  }

  .menu__content {
    padding: calc(var(--unit) * 2.5); /* 20px */
    padding-block-start: calc(var(--unit) * 11); /* 88px */
    padding-inline-start: calc(var(--unit) * 6.5); /* 52px */
  }

  .menu__title {
    font-size: var(--text-2xl);
  }

  .menu__action-label {
    font-size: calc(var(--unit) * 2.25); /* 18px */
  }

  .menu__action-desc {
    font-size: var(--text-sm); /* 12px - closest grid value */
  }

  .menu__form-row {
    flex-direction: column;
    align-items: stretch;
  }

  .menu__form-row .input {
    flex: 1;
    width: 100%;
  }

  .menu__form-row .menu__action {
    width: 100%;
    padding-block: var(--space-2);
  }
}
