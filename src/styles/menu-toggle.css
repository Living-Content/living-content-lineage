/**
 * Menu Toggle Button
 * Hamburger icon with arrow animation for sub-panel navigation
 *
 * Three elements:
 * - top: rotates to form \ (top half of arrow)
 * - bottom: slides up and hides (hamburger bottom bar)
 * - arrow: pre-positioned /, hidden until needed, swings down
 */

/* =============================================
   Toggle Button Container
   ============================================= */
.menu-toggle {
  position: fixed;
  inset-block-start: var(--space-1);
  inset-inline-start: var(--space-1);
  z-index: 10100;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: calc(var(--unit) * 0.75); /* 6px - visual balance */
  width: calc(var(--unit) * 4.5); /* 36px */
  height: calc(var(--unit) * 4.5); /* 36px */
  padding: 0;
  border: none;
  background: none;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  opacity: 0;
  visibility: hidden;
  transition:
    opacity var(--transition-fast),
    visibility 0s 150ms;
}

.menu-toggle:focus {
  outline: none;
}

/* Show when chat is active */
.active ~ .menu-toggle {
  opacity: 1;
  visibility: visible;
  transition:
    opacity var(--transition-slow) 0.5s,
    visibility 0s 0.5s;
}

/* Show when menu is open */
.menu--open ~ .menu-toggle {
  opacity: var(--opacity-secondary);
  visibility: visible;
  transition:
    opacity var(--transition-slow),
    visibility 0s;
}

.menu--open ~ .menu-toggle:hover {
  opacity: 1;
}

/* =============================================
   Toggle Lines
   ============================================= */
.menu-toggle__line {
  display: block;
  width: calc(var(--unit) * 2.25); /* 18px */
  height: calc(var(--unit) * 0.5); /* 4px */
  background: rgb(var(--color-foreground));
  transition:
    transform 150ms ease,
    opacity 150ms ease;
}

/* Top line: rotates around right edge to form \ */
.menu-toggle__line--top {
  transform-origin: right center;
}

/* Bottom line: overshoot when dropping back down */
.menu-toggle__line--bottom {
  transition: transform 150ms cubic-bezier(0.34, 1.56, 0.64, 1), opacity 150ms ease;
}

/* Arrow line: hidden until sub-panel, then swings from -45° to +45° */
.menu-toggle__line--arrow {
  position: absolute;
  transform-origin: left center;
  transform: translate(6px, 8px) rotate(-45deg);
  opacity: 0;
  transition: transform var(--transition-slow);
}

/* =============================================
   Menu Open State (hamburger → single bar)
   ============================================= */
.menu--open ~ .menu-toggle .menu-toggle__line--bottom {
  transform: translateY(calc(var(--unit) * -1.25)); /* -10px */
  opacity: 0;
  transition: transform 150ms ease, opacity 150ms ease;
}

/* =============================================
   Sub-Panel State (single bar → arrow)
   ============================================= */

/* Top line rotates to form \ */
.menu--sub-panel
  ~ .menu-toggle
  .menu-toggle__line--top {
  transform: rotate(-45deg);
  transition: transform 150ms cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Arrow line swings down to form / (waits for top bar to finish) */
.menu--sub-panel
  ~ .menu-toggle
  .menu-toggle__line--arrow {
  transform: translate(5px, 5px) rotate(45deg);
  opacity: 1;
  transition:
    transform 150ms cubic-bezier(0.34, 1.56, 0.64, 1) 150ms,
    opacity 0s 150ms;
}

/* =============================================
   Folding State (arrow → single bar)
   ============================================= */

/* Top line rotates back after arrow finishes swinging to -45° */
.menu--folding ~ .menu-toggle .menu-toggle__line--top {
  transform: rotate(0deg);
  transition: transform 150ms ease-out 150ms;
}

/* Arrow line swings back to -45° then hides */
.menu--folding
  ~ .menu-toggle
  .menu-toggle__line--arrow {
  transform: translate(6px, 8px) rotate(-45deg);
  opacity: 0;
  transition:
    transform 150ms ease-out,
    opacity 0s 150ms;
}
